

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Utility Functions &mdash; approxposterior 0.1.post1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="approxposterior 0.1.post1 documentation" href="../index.html"/>
        <link rel="up" title="API" href="../api.html"/>
        <link rel="prev" title="Likelihood Functions" href="likelihood.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> approxposterior
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial.html">Tutorial</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../api.html">API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="bp.html">bp.py</a></li>
<li class="toctree-l2"><a class="reference internal" href="gmm_utils.html">gmm_utils.py</a></li>
<li class="toctree-l2"><a class="reference internal" href="gp_utils.html">gp_utils.py</a></li>
<li class="toctree-l2"><a class="reference internal" href="mcmc_utils.html">mcmc_utils.py</a></li>
<li class="toctree-l2"><a class="reference internal" href="likelihood.html">likelihood.py</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">utility.py</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="pool.html">pool.py</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/dflemin3/approxposterior">Github</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/dflemin3/approxposterior/issues">Submit an Issue</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">approxposterior</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../api.html">API</a> &raquo;</li>
        
      <li>Utility Functions</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/api/utility.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

/* nice headers on first paragraph of info/warning boxes */
.admonition .first {
    margin: -12px;
    padding: 6px 12px;
    margin-bottom: 12px;
    color: #fff;
    line-height: 1;
    display: block;
}
.admonition.warning .first {
    background: #f0b37e;
}
.admonition.note .first {
    background: #6ab0de;
}
.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<div class="section" id="module-approxposterior.utility">
<span id="utility-functions"></span><h1>Utility Functions<a class="headerlink" href="#module-approxposterior.utility" title="Permalink to this headline">¶</a></h1>
<p>Utility functions</p>
<dl class="function">
<dt id="approxposterior.utility.logsubexp">
<code class="descclassname">approxposterior.utility.</code><code class="descname">logsubexp</code><span class="sig-paren">(</span><em>x1</em>, <em>x2</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/approxposterior/utility.html#logsubexp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#approxposterior.utility.logsubexp" title="Permalink to this definition">¶</a></dt>
<dd><p>Numerically stable way to compute log(exp(x1) - exp(x2))</p>
<p>logsubexp(x1, x2) -&gt; log(exp(x1) - exp(x2))</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>x1</strong> : float</p>
<p><strong>x2</strong> : float</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">logsubexp(x1, x2)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="approxposterior.utility.AGP_utility">
<code class="descclassname">approxposterior.utility.</code><code class="descname">AGP_utility</code><span class="sig-paren">(</span><em>theta</em>, <em>y</em>, <em>gp</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/approxposterior/utility.html#AGP_utility"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#approxposterior.utility.AGP_utility" title="Permalink to this definition">¶</a></dt>
<dd><p>AGP (Adaptive Gaussian Process) utility function, the entropy of the
posterior distribution. This is what you maximize to find the next x under
the AGP formalism. Note here we use the negative of the utility function so
minimizing this is the same as maximizing the actual utility function.</p>
<p>See Wang &amp; Li (2017) for derivation/explaination.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>theta</strong> : array</p>
<blockquote>
<div><p>parameters to evaluate</p>
</div></blockquote>
<p><strong>y</strong> : array</p>
<blockquote>
<div><p>y values to condition the gp prediction on.</p>
</div></blockquote>
<p><strong>gp</strong> : george GP object</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>u</strong> : float</p>
<blockquote class="last">
<div><p>utility of theta under the gp</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="approxposterior.utility.BAPE_utility">
<code class="descclassname">approxposterior.utility.</code><code class="descname">BAPE_utility</code><span class="sig-paren">(</span><em>theta</em>, <em>y</em>, <em>gp</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/approxposterior/utility.html#BAPE_utility"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#approxposterior.utility.BAPE_utility" title="Permalink to this definition">¶</a></dt>
<dd><p>BAPE (Bayesian Active Posterior Estimation) utility function.  This is what
you maximize to find the next theta under the BAPE formalism.  Note here we
use the negative of the utility function so minimizing this is the same as
maximizing the actual utility function.  Also, we log the BAPE utility
function as the log is monotonic so the minima are equivalent.</p>
<p>See Kandasamy et al. (2015) for derivation/explaination.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>theta</strong> : array</p>
<blockquote>
<div><p>parameters to evaluate</p>
</div></blockquote>
<p><strong>y</strong> : array</p>
<blockquote>
<div><p>y values to condition the gp prediction on.</p>
</div></blockquote>
<p><strong>gp</strong> : george GP object</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>u</strong> : float</p>
<blockquote class="last">
<div><p>utility of theta under the gp</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="approxposterior.utility.minimize_objective">
<code class="descclassname">approxposterior.utility.</code><code class="descname">minimize_objective</code><span class="sig-paren">(</span><em>fn</em>, <em>y</em>, <em>gp</em>, <em>sample_fn</em>, <em>prior_fn</em>, <em>bounds=None</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/approxposterior/utility.html#minimize_objective"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#approxposterior.utility.minimize_objective" title="Permalink to this definition">¶</a></dt>
<dd><p>Find point that minimizes fn for a gaussian process gp conditioned on y,
the data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>fn</strong> : function</p>
<blockquote>
<div><p>function to minimize that expects x, y, gp as arguments aka fn looks
like fn_name(x, y, gp).  See <a href="#id1"><span class="problematic" id="id2">*</span></a>_utility functions above for examples.</p>
</div></blockquote>
<p><strong>y</strong> : array</p>
<blockquote>
<div><p>y values to condition the gp prediction on.</p>
</div></blockquote>
<p><strong>gp</strong> : george GP object</p>
<p><strong>sample_fn</strong> : function</p>
<blockquote>
<div><p>Function to sample initial conditions from.</p>
</div></blockquote>
<p><strong>prior_fn</strong> : function</p>
<blockquote>
<div><p>Function to apply prior to.</p>
</div></blockquote>
<p><strong>kw</strong> : dict (optional)</p>
<blockquote>
<div><p>Any additional keyword arguments scipy.optimize.minimize could use,
e.g., method.</p>
</div></blockquote>
<p><strong>bounds</strong> : tuple/iterable (optional)</p>
<blockquote>
<div><p>Bounds for minimization scheme.  See scipy.optimize.minimize details
for more information.  Defaults to None.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>theta</strong> : (1 x n_dims)</p>
<blockquote class="last">
<div><p>point that minimizes fn</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="approxposterior.utility.function_wrapper">
<em class="property">class </em><code class="descclassname">approxposterior.utility.</code><code class="descname">function_wrapper</code><span class="sig-paren">(</span><em>f</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/approxposterior/utility.html#function_wrapper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#approxposterior.utility.function_wrapper" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper class for functions.</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code>(x)</td>
<td>Call the function on some input x.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="approxposterior.utility.kl_numerical">
<code class="descclassname">approxposterior.utility.</code><code class="descname">kl_numerical</code><span class="sig-paren">(</span><em>x</em>, <em>p</em>, <em>q</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/approxposterior/utility.html#kl_numerical"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#approxposterior.utility.kl_numerical" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimate the KL-Divergence between pdfs p and q via Monte Carlo intergration
using x, samples from p.</p>
<p>KL ~ 1/n * sum_{i=1,n}(log (p(x_i)/q(x_i)))</p>
<p>For our purposes, q is the current estimate of the pdf
while p is the previous estimate.  This method is the
only feasible method for large dimensions.</p>
<p>See Hershey and Olsen, “Approximating the Kullback Leibler
Divergence Between Gaussian Mixture Models” for more info</p>
<p>Note that this method can result in D_kl &lt; 0 but it’s the only method with
convergence properties as the number of samples (len(x)) grows.  Also, this
method is shown to have the lowest error, on average (see Hershey and Olsen).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>x</strong> : array</p>
<blockquote>
<div><p>Samples drawn from p</p>
</div></blockquote>
<p><strong>p</strong> : function</p>
<blockquote>
<div><p>Callable previous estimate of the density</p>
</div></blockquote>
<p><strong>q</strong> : function</p>
<blockquote>
<div><p>Callable current estimate of the density</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>kl</strong> : float</p>
<blockquote class="last">
<div><p>KL divergence</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="likelihood.html" class="btn btn-neutral" title="Likelihood Functions" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, David P. Fleming.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.1.post1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>